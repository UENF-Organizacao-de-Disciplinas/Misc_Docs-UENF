# Trabalho final

```{r setup, include=FALSE, cache = FALSE}
library(knitr)
cwd <- getwd()
opts_knit$set(root.dir = cwd)
opts_chunk$set(root.dir = cwd)
knitr::opts_knit$set(root.dir = cwd)
isKnitting <- isTRUE(getOption("knitr.in.progress"))
isKnitting
```

```{r Instalando_as_bibliotecas}
options(repos = c(CRAN = "https://cran.r-project.org/"))
install.packages("lubridate")
install.packages("tidyverse")
```

```{r Carregando_as_bibliotecas}
library(tidyverse)
library(lubridate)
```

```{r Obtendo_c√≥digo_dos_arquivos}
years <- c(2017:2022)
sufix <- "ListagemChamadaRegular_"
extension <- "-1.csv"
all_complete_file_codes <- paste0(sufix, years, extension)
data_path <- "full/"
files_to_be_imported <- paste0(data_path, all_complete_file_codes)

```
<!-- 
ANO	Ano da edi√ß√£o	Num√©rico	Ano do processo seletivo
XXX               EDICAO	N√∫mero da Edi√ß√£o (semestre)	Num√©rico	N√∫mero da edi√ß√£o do processo seletivo no ano de refer√™ncia
CODIGO_ETAPA	C√≥digo da etapa	Num√©rico	C√≥digo da etapa no Sisu Gest√£o. Refere-se ao per√≠odo de inscri√ß√£o, chamada regular ou lista de espera
ETAPA	Nome da etapa	Alfanum√©rico	Informa qual √© a etapa do processo seletivo: se Inscri√ß√£o, resultado da Chamada Regular (1¬™, 2¬™ ou 3¬™ conforme a edi√ß√£o), ou informa√ß√£o da Lista de Espera
CODIGO_IES	C√≥digo da IES	Num√©rico	C√≥digo da institui√ß√£o de ensino superior confome informa√ß√µes do cadastro e-MEC
XXX               NOME_IES	Nome da IES	Alfanum√©rico	Nome da institui√ß√£o de ensino superior confome informa√ß√µes do cadastro e-MEC
SIGLA_IES	Sigla da IES	Alfanum√©rico	Sigla da institui√ß√£o de ensino superior confome informa√ß√µes do cadastro e-MEC
XXX               UF_IES	UF da IES	Alfanum√©rico	Sigla UF do campus sede da institui√ß√£o de ensino superior confome informa√ß√µes do cadastro e-MEC
XXX               CODIGO_CAMPUS	C√≥digo do campus	Num√©rico	C√≥digo do campus da institui√ß√£o de ensino superior confome informa√ß√µes do cadastro e-MEC
XXX               NOME_CAMPUS	Nome do campus	Alfanum√©rico	Nome do campus da institui√ß√£o de ensino superior confome informa√ß√µes do cadastro e-MEC
XXX               UF_CAMPUS	UF do campus	Alfanum√©rico	Sigla da unidade da federa√ß√£o (UF) na qual est√° localizada o campus da institui√ß√£o de ensino superior confome informa√ß√µes do cadastro e-MEC
XXX               MUNICIPIO_CAMPUS	Munic√≠pio do campus	Alfanum√©rico	Nome do munic√≠pio do campus da institui√ß√£o de ensino superior confome informa√ß√µes do cadastro e-MEC
CODIGO_CURSO	C√≥digo do curso	Num√©rico	C√≥digo do curso da institui√ß√£o de ensino superior confome informa√ß√µes do cadastro e-MEC
NOME_CURSO	Nome do curso	Alfanum√©rico	Nome do curso da institui√ß√£o de ensino superior confome informa√ß√µes do cadastro e-MEC
XXX               GRAU	Grau do curso	Alfanum√©rico	Grau do curso da institui√ß√£o de ensino superior confome informa√ß√µes do cadastro e-MEC
XXX               TURNO	Turno do curso	Alfanum√©rico	Turno do curso da institui√ß√£o de ensino superior confome informa√ß√µes do cadastro e-MEC
TIPO_MOD_CONCORRENCIA	Tipo da modalidade de concorr√™ncia	Alfanum√©rico	Tipo da modalidade da oferta do curso no processo seletivo
MOD_CONCORRENCIA	Modalidade de concorr√™ncia	Alfanum√©rico	Descri√ß√£o do tipo da modalidade de concorr√™ncia ofertada para o curso no processo seletivo
PERCENTUAL_BONUS	Percentual do b√¥nus	Num√©rico	Percentual de b√¥nus definido para as a√ß√µes afirmativas pr√≥prias das IES
PESO_L	Peso para Liguagens	Num√©rico	Peso atribu√≠do pela institui√ß√£o, na ades√£o ao Sisu, para a prova de linguagens do Enem na oferta do curso no processo seletivo
PESO_CH	Peso para Ci√™ncias Humanas	Num√©rico	Peso atribu√≠do pela institui√ß√£o, na ades√£o ao Sisu, para a prova de ci√™ncias humanas do Enem na oferta do curso no processo seletivo
PESO_CN	Peso para Ci√™ncias da Natureza	Num√©rico	Peso atribu√≠do pela institui√ß√£o, na ades√£o ao Sisu, para a prova de ci√™ncias da natureza do Enem na oferta do curso no processo seletivo
PESO_M	Peso para Matem√°tica	Num√©rico	Peso atribu√≠do pela institui√ß√£o, na ades√£o ao Sisu, para a prova de matem√°tica do Enem na oferta do curso no processo seletivo
PESO_R	Peso para Reda√ß√£o	Num√©rico	Peso atribu√≠do pela institui√ß√£o, na ades√£o ao Sisu, para a prova de reda√ß√£o do Enem na oferta do curso no processo seletivo
NOTA_MINIMA_L	Nota m√≠nima para Liguagens	Num√©rico	Nota m√≠nima atribu√≠da pela institui√ß√£o, na ades√£o ao Sisu, para a prova de linguagens do Enem na oferta do curso no processo seletivo
NOTA_MINIMA_CH	Nota m√≠nima para Ci√™ncias Humanas	Num√©rico	Nota m√≠nima atribu√≠da pela institui√ß√£o, na ades√£o ao Sisu, para a prova de ci√™ncias humanas do Enem na oferta do curso no processo seletivo
NOTA_MINIMA_CN	Nota m√≠nima para Ci√™ncias da Natureza	Num√©rico	Nota m√≠nima atribu√≠da pela institui√ß√£o, na ades√£o ao Sisu, para a prova de ci√™ncias da natureza do Enem na oferta do curso no processo seletivo
NOTA_MINIMA_M	Nota m√≠nima para Matem√°tica	Num√©rico	Nota m√≠nima atribu√≠da pela institui√ß√£o, na ades√£o ao Sisu, para a prova de matematica do Enem na oferta do curso no processo seletivo
NOTA_MINIMA_R	Nota m√≠nima para Reda√ß√£o	Num√©rico	Nota m√≠nima atribu√≠da pela institui√ß√£o, na ades√£o ao Sisu, para a prova de reda√ß√£o do Enem na oferta do curso no processo seletivo
MEDIA_MINIMA	M√©dia m√≠nima das provas do ENEM	Num√©rico	M√©dia aritm√©tica m√≠nima (n√£o considera pesos) atribu√≠da pela institui√ß√£o, na ades√£o ao Sisu, tendo em vista os cinco tipos de provas do Enem (Reda√ß√£o, Linguagens, Matem√°tica, Ci√™ncias Humanas e Ci√™ncias da Natureza)
CPF	Cadastro pessoa f√≠sica (CPF)	Num√©rico	Este √© o CPF do estudante (neste relat√≥rio p√∫blico n√£o pode ser informado completo em atendimento a Lei de Acesso √† Informa√ß√£o e a Lei Geral de Prote√ß√£o de Dados)
INSCRICAO_ENEM	N√∫mero da inscri√ß√£o ENEM	Num√©rico	O c√≥digo de inscri√ß√£o do estudante no exame do ENEM/INEP (neste relat√≥rio p√∫blico n√£o pode ser informado completo em atendimento a Lei de Acesso √† Informa√ß√£o e a Lei Geral de Prote√ß√£o de Dados)
INSCRITO	Nome do inscrito	Alfanum√©rico	Este √© o nome do estudante
SEXO	Sexo do inscrito	Alfanum√©rico	Informa qual √© o sexo do estudante conforme preenchido pelo estudante no question√°rio socioecon√¥mico do ENEM/INEP
DATA_NASCIMENTO	Data de nascimento do inscrito	Num√©rico	Informa a data de nascimento do estudante conforme preenchido pelo estudante no question√°rio socioecon√¥mico do ENEM/INEP
UF_CANDIDATO	UF do candidato	Alfanum√©rico	Informa qual √© a UF do munic√≠pio de resid√™ncia do estudante conforme preenchido pelo estudante no question√°rio socioecon√¥mico do ENEM/INEP
MUNICIPIO_CANDIDATO	Munic√≠pio de resid√™ncia do candidato	Alfanum√©rico	Informa qual √© o munic√≠pio de resid√™ncia do estudante conforme preenchido pelo estudante no question√°rio socioecon√¥mico do ENEM/INEP
OPCAO	Op√ß√£o do candidato	Num√©rico	Informa se √© a 1¬™ ou 2¬™ op√ß√£o do estudante
NOTA_L	Nota Linguagens do estudante	Num√©rico	Esta √© a nota que o estudante tirou na prova de linguagens do ENEM/INEP
NOTA_CH	Nota Ci√™ncias Humanas do estudante	Num√©rico	Esta √© a nota que o estudante tirou na prova de ci√™ncias humanas do ENEM/INEP
NOTA_CN	Nota Ci√™ncias da Natureza do estudante	Num√©rico	Esta √© a nota que o estudante tirou na prova de ci√™ncias da natureza do ENEM/INEP
NOTA_M	Nota Matem√°tica do estudante	Num√©rico	Esta √© a nota que o estudante tirou na prova de matem√°tica do ENEM/INEP
NOTA_R	Reda√ß√£o do estudante	Num√©rico	Esta √© a nota que o estudante tirou na prova de reda√ß√£o do ENEM/INEP
NOTA_L_COM_PESO	Nota Linguagens do estudante (multiplicado pelo peso)	Num√©rico	√â o resultado do c√°lculo de NU_NOTA_L multiplicado pelo NU_PESO_L
NOTA_CH_COM_PESO	Nota Ci√™ncias Humanas do estudante (multiplicado pelo peso)	Num√©rico	√â o resultado do c√°lculo de NU_NOTA_CH multiplicado pelo NU_PESO_CH
NOTA_CN_COM_PESO	Nota Ci√™ncias da Natureza do estudante (multiplicado pelo peso)	Num√©rico	√â o resultado do c√°lculo de NU_NOTA_CN multiplicado pelo NU_PESO_CN
NOTA_M_COM_PESO	Nota Matem√°tica do estudante (multiplicado pelo peso)	Num√©rico	√â o resultado do c√°lculo de NU_NOTA_M multiplicado pelo NU_PESO_M
NOTA_R_COM_PESO	Reda√ß√£o do estudante (multiplicado pelo peso)	Num√©rico	√â o resultado do c√°lculo de NU_NOTA_R multiplicado pelo NU_PESO_R
NOTA_CANDIDATO	Nota do candidato	Num√©rico	Essa √© a nota que o candidato concorreu para a op√ß√£o de curso escolhida. Essa nota √© a m√©dia que √© calculada a partir da nota do estudante em cada prova do ENEM, considera os pesos definidos pelas IES para cada prova do ENEM e, ainda, se for o caso, considera o b√¥nus da a√ß√£o afirmativa do tipo b√¥nus (se foi uma a√ß√£o assim escolhida pelo estudante - ver coluna DS_MOD_CONCORRENCIA e coluna NU_PERCENTUAL_BONUS)
NOTA_CORTE	Nota de corte do curso	Num√©rico	Nota de corte da modalidade/curso conforme o resultado da chamada regular. A nota de corte √© sempre igual a nota do √∫ltimo candidato classificado na √∫ltima vaga ofertada para a modalidade/curso escolhida. Na modalidade de b√¥nus a nota de corte √© a mesma da modalidade ampla concorr√™ncia do mesmo curso porque as pessoas que se inscreveram na modalidade b√¥nus concorrem pelas vagas ofertadas para ampla concorr√™ncia do mesmo curso/grau/turno/campus/IES. Alguns cursos podem n√£o apresentar nota de corte pois n√£o tiveram n√∫mero de inscritos pelo menos igual ao n√∫mero de vagas ou porque tiveram poucos inscritos e alguns desses inscritos tiveram sele√ß√£o na 1¬™ op√ß√£o de curso e, portanto, n√£o t√™m sua nota considerada para sua 2¬™ op√ß√£o de inscri√ß√£o
CLASSIFICACAO	Classifica√ß√£o do estudante no curso	Num√©rico	Informa qual a coloca√ß√£o do estudante considerando todos os inscritos para o mesmo curso
APROVADO	Informa aprova√ß√£o na CR	Alfanum√©rico	Informa se o estudante foi aprovado ou n√£o na chamada regular em sua op√ß√£o de curso
MATRICULA	Informa matr√≠cula na CR ou LE	Alfanum√©rico	Informa a situa√ß√£o de "matr√≠cula" registrado pelas institui√ß√µes no Sisu Gest√£o, por exemplo: matriculado, ou documenta√ß√£o rejeitada, ou n√£o compareceu etc. Se na chamada regular ou na lista de espera


 -->
```{r}
interesting_cols <- c(1,2,3,4,5)
files_to_be_imported <- c("full/ListagemChamadaRegular_2022_1.csv")
```
```{r Importando_colunas_desejadas}
imported_db <- read_delim(
  file = files_to_be_imported,
  delim = "|"
  # col_select = all_of(interesting_cols),
  # name_repair = "universal",
  # locale = locale(
  #   decimal_mark = ","
  # ),
  # col_types = cols(
  #   Data.da.Coleta = col_date(
  #     format = "%d/%m/%Y"
  #   ),
  #   Produto = col_factor()
  # )
)
```

```{r Simple_glimpse}
debugging <- imported_db |>
  distinct(ANO)
glimpse(debugging)
```

```{r Importing_to_Tidying}
tidying_db <- imported_db
```

```{r Renomeando_colunas}
uenf <- 1027
cc <- 101984
tidying_db <- tidying_db |>
  filter(
    CODIGO_IES == uenf,
    CODIGO_CURSO == cc,
    # curso == "CI√äNCIA DA COMPUTA√á√ÉO"
  )
```

```{r}
glimpse(tidying_db)
```
```{r}

tidying_db <- tidying_db |>
  select(

  )
```
```{r Checando_linhas_com_NA}
count(tidying_db[rowSums(is.na(tidying_db)) > 0, ])
```

Nenhuma das 3 colunas que selecionamos apresenta valores NA. Mas caso desej√°ssemos remov√™-los, executar√≠amos o comando abaixo.

```{r Removendo_linhas_com_NA}
tidying_db <- drop_na(tidying_db)
```

#### Selecionar apenas um tipo de combust√≠vel

Para simplificar a visualiza√ß√£o, aqui escolhemos apenas um tipo de combust√≠vel para ser analisado. Como gasolina tende a ser o mais frequente e tamb√©m √© o que apresenta a maior quantidade de observa√ß√µes, sendo o campe√£o com 7.250.069 observa√ß√µes no presente momento de limpezas, ela ser√° a escolhida para estar disposta no gr√°fico. Como toda a tabela agora estar√° relacionada a este combust√≠vel escolhido, a coluna "produto" pode deixar de existir em nossa tabela.

```{r Selecionar_tipo_de_combust√≠vel}
combustiveis <- c("GASOLINA", "ETANOL", "DIESEL", "GNV")
combustivel_escolhido <- combustiveis[1]

tidying_db <-
  tidying_db |>
  filter(produto == combustivel_escolhido) |>
  select(-produto)
```

#### Ordenar por data crescente

Para deixar organizadinho, ordenemos por data.

```{r Ordenar_por_data}
tidying_db <- tidying_db |>
  arrange(data)
```

#### Finalizando o tidy

Por fim, assim como come√ßamos a etapa de limpeza adicionando o dado importado a uma vari√°vel de transi√ß√£o, finalizamos aqui a transi√ß√£o e temos por fim o nosso dataset limpo.

```{r Tidying_to_Tidied}
tidied_db <- tidying_db
```

### Understand: Transform

Nesta etapa iremos manipular de forma mais "assertiva" os dados. Criando colunas, mudando valores, etc.

#### Vari√°vel de transforma√ß√£o

Mais uma vari√°vel de transi√ß√£o como j√° se deve ter acostumado.

```{r Tidied_to_transforming}
transforming_db <- tidied_db
```

#### Obter a m√©dia dos pre√ßos por cada dia

Para obtermos um valor mais dentro da realidade ao redor dos diversos postos/revendas espalhadas pelo Brasil, definiremos que cada dia ter√° como valor correspondente a m√©dia de todos os outros valores deste combust√≠vel medidos no mesmo dia.

```{r Obtendo_valor_medio_do_combustivel}
transforming_db <- transforming_db |>
  group_by(data) |>
  summarise(valor = mean(valor)) |>
  ungroup()
```

#### Definir qual presidente estava no poder

Aqui definimos as informa√ß√µes quanto a quais presidentes estavam em exerc√≠cio em quais per√≠odos de tempo. Tamb√©m definimos uma fun√ß√£o que nos auxilia para obter facilmente o presidente a partir de uma data espec√≠fica. Isso ser√° carregado agora, mas utilizado posteriormente.

Os n√∫meros 1 e 2 est√£o sendo usados para indicar qual mandato est√° sendo representado.

```{r Regencias_dos_governantes}
lula1 <- interval(ymd("2003-01-01"), ymd("2006-12-31"))
lula2 <- interval(ymd("2007-01-01"), ymd("2010-12-31"))
dilm1 <- interval(ymd("2011-01-01"), ymd("2014-12-31"))
dilm2 <- interval(ymd("2015-01-01"), ymd("2016-08-31"))
temer <- interval(ymd("2016-09-01"), ymd("2018-12-31"))
bolso <- interval(ymd("2019-01-01"), ymd("2022-12-31"))
presidentes_l <- list(
  l1 = lula1,
  l2 = lula2,
  d1 = dilm1,
  d2 = dilm2,
  tm = temer,
  bn = bolso
)
get_president_by_date <- function(myDate) {
  resultado <- case_when(
    myDate %within% presidentes_l$l1 ~ "Lula 1",
    myDate %within% presidentes_l$l2 ~ "Lula 2",
    myDate %within% presidentes_l$d1 ~ "Dilma 1",
    myDate %within% presidentes_l$d2 ~ "Dilma 2",
    myDate %within% presidentes_l$tm ~ "Temer",
    myDate %within% presidentes_l$bn ~ "Bolsonaro",
    TRUE ~ "Outro"
  )
  return(resultado)
}
```

#### Criando coluna presidentes

Aqui usamos o que carregamos anteriormente, definindo uma coluna apenas para indicar quem estava na presid√™ncia no momento.

```{r Criando_coluna_presidentes}
transforming_db <- transforming_db |>
  mutate(
    presidentes = get_president_by_date(data)
  )
```

#### Convertendo para factor

Como estamos utilizando valores categ√≥ricos, vamos converter esta coluna para o tipo factor que √© mais denso e permite colocarmos uma certa ordem de prioridades que ser√° √∫til na hora da gera√ß√£o da legenda.

```{r Convertendo_coluna_presidentes_para_factor}
transforming_db$presidentes <- as.factor(transforming_db$presidentes)
transforming_db$presidentes <- factor(transforming_db$presidentes, levels = c(
  "Bolsonaro",
  "Temer",
  "Dilma 2",
  "Dilma 1",
  "Lula 2",
  "Lula 1"
))
```

###### imüçëment

Como sabemos, a Dilma sofreu impeachment e foi sucedida pelo Temer. Para isso, armazenaremos essa informa√ß√£o para uso futuro.

```{r Calculando_data_do_impeachment}
minha_data_base <- ymd("0001-01-01")
impeachment <- transforming_db |>
  filter(presidentes == "Dilma 2") |>
  mutate(data = minha_data_base + (data - min(data))) |>
  arrange(desc(data)) |>
  slice_head(n = 1) |>
  select(data)
impeachment_date <- impeachment$data
```

#### Normaliza√ß√£o dos valores e colocando-os em um mesmo intervalo

Aqui convertemos as datas para torn√°-las relativas ao in√≠cio do mandato de cada um, nesse caso se baseando na data mais recente de que se tem no banco de dados (o que acabou gerando problemas que foram contornados).

```{r Calculando_tempo_de_governo_relativo}
minha_data_base <- ymd("0001-01-01")
defasagem_do_lula <- ymd("2004-05-10") - ymd("2003-01-01")
transforming_db <- transforming_db |>
  group_by(presidentes) |>
  mutate(
    data = minha_data_base + (data - min(data)) +
      if_else(
        presidentes == "Lula 1",
        defasagem_do_lula,
        minha_data_base - minha_data_base
      )
  ) |>
  ungroup()
```

#### Modificando per√≠odo do Temer

Para tornar o gr√°fico mais interessante, achei prefer√≠vel colocar o Temer logo em seguinda do segundo mandato da Dilma, por isso realizei as modifica√ß√µes abaixo nas datas do Temer.

```{r Modificando_periodo_do_temer}
data_inicial <- ymd("0001-01-01")

transforming_db <- transforming_db |>
  group_by(presidentes) |>
  mutate(
    data = data +
      if_else(
        presidentes == "Temer",
        impeachment_date - as.Date(data_inicial),
        as.Date(data_inicial) - as.Date(data_inicial)
      )
  )
```

#### Terminando a transforma√ß√£o

Dados transformados com sucesso. üòÄüëç

```{r Transforming_to_Transformed}
transformed_db <- transforming_db
```

## An√°lise dos dados
<!-- Crie pelo menos uma visualiza√ß√£o dos seus dados de acordo com o problema ou pergunta que est√° investigando. Explique o que est√° sendo visualizado, e interprete o gr√°fico. Essa √© a parte mais importante do relat√≥rio. -->

Nesta etapa visamos mostrar de forma visual e descritiva os resultados encontrados nos procedimentos anteriores.

### Visualiza√ß√£o

Caracter√≠sticas gerais do gr√°fico:

1. Usa os dados filtrados como base, mapeando as datas para o eixo x e os valores do combust√≠vel para o eixo y
2. Tra√ßa uma linha suavizada com sua respectiva margem de erro
3. Define que a escala do gr√°fico ser√° referente a intervalos de semestres ao longo dos anos de mandato

```{r Plottando_grafico}
ggplot(transformed_db, aes(x = data, y = valor, color = presidentes)) +
  geom_smooth() +
  scale_x_continuous(
    breaks = seq(
      min(transformed_db$data),
      max(transformed_db$data),
      by = "6 months"
    ),
    labels = 1:8
  ) +
  ggtitle(
    paste(
      "Rela√ß√£o do pre√ßo de",
      tolower(combustivel_escolhido),
      "por presidente"
    )
  ) +
  labs(
    y = paste("R$", tolower(combustivel_escolhido)),
    x = "Semestres"
  ) +
  guides(color = guide_legend(title = "Presidentes")) +
  scale_color_manual(
    # values = c("#005580", "#333333", "#cb8777", "#b4604e", "#9b3928", "#800000")
    values = c("#00ff04", "#333333", "#711f1f", "#940000", "#ff3232", "#FF0000")
  )
```

#### Salvar a imagem

Por fim, salvemos a imagem üñºÔ∏è! Eu utilizei um √≠ndice (atualmente em 43) pois fui gerando diversas imagens de teste ao longo do processo de testes.

```{r Definindo_indice}
index <- 43
```
```{r Salvando_imagem}
index <- index + 1
ggsave(
  filename = paste0("meu_grafico_", index, ".png"),
  path = paste0(base_path, "Imagens"),
  width = 8,
  height = 5,
  dpi = 300
)
```

### Comunicando as interpreta√ß√µes

Nesta etapa busco trazer parte da sequ√™ncia de gr√°ficos gerados em busca do gr√°fico final desejado, bem como uma breve an√°lise para cada um deles

- **Prova de conceito**

![](Imagens/meu_grafico_1.png)

A imagem acima representou o primeiro marco visual no desenvolvimento. Ela representava, se n√£o me engano, a varia√ß√£o do pre√ßo do GNV entre 2004 e 2009. O GNV foi escolhido por ter poucas observa√ß√µes em rela√ß√£o aos outros. Quanto ao gr√°fico, vemos um crescimento quase linear de seu pre√ßo ao longo desses anos.

- **Quantidade mais elevada de dados**

![](Imagens/meu_grafico_10-por_dia.png)

Se n√£o me engano, este continua ilustrando o valor do GNV, s√≥ que dessa vez contemplando uma quantidade maior de dados.

- **Colora√ß√£o por presidente**

![](Imagens/meu_grafico_15.png)

Come√ßamos a entrar na onda colorida e o gr√°fico agora tamb√©m est√° mais explicativo. Ele ilustra a legenda para as cores, tamb√©m apresenta um t√≠tulo e textos customizados para os valores laterais. Aqui j√° come√ßamos a ter uma resposta para a pergunta feita inicialmente "De que forma o valor do combust√≠vel tende a variar ao longo do governo das presid√™ncias?" E vemos que no governo do Temer e no governo do Bolsonaro houveram crescimentos no valor do combust√≠vel de forma muito mais intensa do que os da Dilma e do Lula.

- **Gr√°fico por tempo de governo**

![](Imagens/meu_grafico_28.png)

Aqui ocorre a maior aproxima√ß√£o vista at√© agora do gr√°fico idealizado inicialmente. Assim como no anterior, tamb√©m conseguimos responder √† pergunta proposta, dessa vez com uma visualiza√ß√£o um pouco mais densa que a anterior e que traz a data relativa de governo ao inv√©s da data na qual os governantes estiveram no poder, Assim podendo analisar de que forma cada uma das linhas se comportou ao longo de seu per√≠odo de mandato. Com isso, conseguimos constatar que a taxa de variabilidade tende a ser bem maior ap√≥s o primeiro ano de governo.

- **Resultado final**

![](Imagens/meu_grafico_44.png)

Com isso alcan√ßamos o resultado final. Podemos ent√£o analisar a forma com o pre√ßo do combust√≠vel tem variado ao logo dos semestres de governo de cada um dos presidentes presentes no dataset. √â interessante perceber que nos governos de Lula 1 e 2, e durante o governo 1 de Dilma, o pre√ßo de combust√≠vel se apresentou consideravelmente est√°vel, sem grandes varia√ß√µes bruscas de crescimento.

## Conclus√£o
<!-- Ressalte os seus achados, aborde poss√≠veis limita√ß√µes e poss√≠veis futuros desdobramentos da sua an√°lise. Talvez -->

Tendo conclu√≠do todos os procedimentos acima, acabamos de ver o resultado final encontrado. Com isso, ser√£o analisados alguns aspectos gerais do trabalho.

### Busca dos dados

Durante o processo de pesquisa, foi dif√≠cil e divertido o processo de busca por dados que viessem a chamar aten√ß√£o e que parecessem render gr√°ficos interessantes para tratar aqui neste trabalho. Mas ap√≥s vagar pela [Base dos dados][BaseDados], pelo [site do governo][DadosGoverno] e por [alguns dados da CNPq][DadosCNPq], tive acesso a alguns bons conjuntos de dados e dei sorte do que escolhi j√° estar consideravelmente bem organizado.

[BaseDados]: https://basedosdados.org/
[DadosGoverno]: https://dados.gov.br/dados/conjuntos-dados
[DadosCNPq]: https://dadosabertos.cnpq.br/pt_BR

### Etapas

Vejamos agora algumas considera√ß√µes quanto as etapas realizadas.

#### importa√ß√£o

A importa√ß√£o, embora possa ter um caminho simples e direto, tem um consider√°vel n√∫mero de "armadilhas". Algumas das que ocorreram pra mim foram:

- A forma como o R ir√° interpretar os dados n√£o usuais
- O volume de dados a ser importado
- Os benef√≠cios e malef√≠cios de se importar os dados por caminhos diferentes

E uma coisa que achei interessante foi o quanto √© poss√≠vel utilizar da etapa de importa√ß√£o para j√° preparar os dados para as etapas posteriores.

#### Tratamento dos dados

Embora j√° estivessem bem organizados, alguns detalhes foram modificados para poder tornar mais f√°cil de se manipular. Esta parte n√£o deu muito problema, a n√£o ser por eu n√£o conseguir modificar o nome das colunas importadas durante a pr√≥pria importa√ß√£o, que eu suponho ser poss√≠vel com o par√¢metro `col_names` da fun√ß√£o `read_csv`.

Aqui eu percebi uma certa dificuldade de tra√ßar a linha adequada entre a busca pela tabela tidy e a transforma√ß√£o da tabela para o que desejo alcan√ßar. Mas posteriormente foi poss√≠vel distinguir e definir onde termina um e come√ßa outro.

#### Transforma√ß√£o dos dados

Tendo sido realizada uma boa organiza√ß√£o pr√©via, a manipula√ß√£o para se alcan√ßar a tabela final desejada n√£o apresentou muitos problemas. At√© que aos poucos e atrav√©s da an√°lise, foi-se percebendo que o gr√°fico ilustrado apresentava algumas incongru√™ncias que foram posteriormente descobertas e tratadas.

#### visualiza√ß√£o

Embora as etapas anteriores tenham aparentado relativa simplicidade, isso n√£o resultou em um trabalho f√°cil, sendo dispendidas horas em cada uma das etapas. Que apenas no final, por pobre planejamento pr√©vio, acabou mostrando necessidade de se refatorar parte dos c√≥digos anteriores, visto que a estrutura produzida at√© ent√£o n√£o era o suficiente para ilustrar o que se planejava inicialmente.

Ap√≥s algumas refatora√ß√µes do c√≥digo de cima a baixo, pode-se acal√ßar por fim um c√≥digo bastante modular, mas preferencialmente sequencial.

### Achados, limita√ß√µes e desdobramentos futuros
<!-- Ressalte os seus achados, aborde poss√≠veis limita√ß√µes e poss√≠veis futuros desdobramentos da sua an√°lise. Talvez -->

Inicialmente visava-se encontrar uma rela√ß√£o direta entre presidente em exerc√≠cio e pre√ßos dos combust√≠veis, para possivelmente chegarmos no resultado de que alguma das presid√™ncias tenha tido um forte impacto no aumento dos pre√ßos. Entretanto, o que se pode ver √© que, dada a limita√ß√£o dos dados analisados, n√£o se pode haver uma compara√ß√£o direta das flutua√ß√µes de pre√ßo ao longo do tempo diretamente com as a√ß√µes das presid√™cias, visto que n√£o h√° compara√ß√£o com os valores globais de combust√≠veis, nem com poss√≠veis decis√µes governamentais que possam ter impactado a varia√ß√£o.

Entretanto, pode-se perceber o vis√≠vel aumento dos pre√ßos dos combust√≠veis geral entre os governantes, a n√£o ser no segundo mandato do Lula.

Quanto a an√°lises futuras, uma simples e interessante seria ver a compara√ß√£o entre o crescimento de cada um dos tipos de combust√≠vel. Outra, que demandaria maior pesquisa e estudo seria uma para responder a pergunta inicial, talvez tendendo a uma visualiza√ß√£o similar a esta abaixo que mostra a taxa de mortes por dia devido √† pandemia e as falas do ent√£o presidente.

![](https://i0.wp.com/cartacampinas.com.br/wordpress/wp-content/uploads/falas-de-bolsonaro-e-gra%C2%B4fico-da-covid-19-coronav%C3%ADrus.jpg)

Na visualiza√ß√£o que proponho, haveriam algumas medidas tomadas pelos governantes que possam ser consideradas relevantes a varia√ß√£o do pre√ßo do combust√≠vel, como por exemplo a [paraliza√ß√£o dos caminhoneiros][Caminh√£o] e o [navio encalhado em 2021][Navio], bem como a compara√ß√£o dos [pre√ßos de combust√≠vel no Brasil][BRGasPrices] com os [pre√ßos internacionais][GasPrices].

[BolsonaroXCOVID]: https://i0.wp.com/cartacampinas.com.br/wordpress/wp-content/uploads/falas-de-bolsonaro-e-gra%C2%B4fico-da-covid-19-coronav%C3%ADrus.jpg?resize=1080%2C766&ssl=1
[Caminh√£o]: https://www.brasildefato.com.br/2022/06/17/apos-novo-aumento-nos-combustiveis-lider-de-caminhoneiros-diz-que-greve-e-provavel#:~:text=O%20pre%C3%A7o%20m%C3%A9dio%20para%20as,%24%200%2C63%20por%20litro.
[Navio]: https://quatrorodas.abril.com.br/noticias/navio-encalhado-no-egito-pode-encarecer-ainda-mais-o-combustivel-no-brasil/
[BRGasPrices]: https://dados.gov.br/dados/organizacoes/visualizar/agencia-nacional-do-petroleo-gas-natural-e-biocombustiveis-anp
[GasPrices]: https://www.globalpetrolprices.com/data_download.php
